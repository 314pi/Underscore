<link rel='stylesheet' href='what.css' type='text/css' />
<h3>NAME</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;--&nbsp;<span&nbsp;class='description'>Parse&nbsp;command&nbsp;line&nbsp;options&nbsp;and&nbsp;create&nbsp;environment&nbsp;vars</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>SYNOPSIS</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;%*</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;$NAME=x</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::Parse&nbsp;options&nbsp;to&nbsp;current&nbsp;script</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;%*</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::Show&nbsp;options</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@x</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::Clear&nbsp;env&nbsp;vars</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>DESCRIPTION</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;$NAME&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;environment&nbsp;var&nbsp;"UNDEFINED"&nbsp;is&nbsp;used&nbsp;as&nbsp;$NAME</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;NOTE!</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;you&nbsp;entend&nbsp;to&nbsp;nest&nbsp;scripts&nbsp;both&nbsp;using&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;you&nbsp;must&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start&nbsp;the&nbsp;nested&nbsp;script&nbsp;with&nbsp;a&nbsp;SETLOCAL&nbsp;statement&nbsp;to&nbsp;preserve</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;callers&nbsp;environment!</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>EXAMPLES:</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;x.bat&nbsp;contains&nbsp;the&nbsp;statement:</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;$NAME=x</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;%*</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Enable&nbsp;delayed&nbsp;expansion&nbsp;of&nbsp;vars&nbsp;to&nbsp;use&nbsp;content&nbsp;of&nbsp;vars</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECHO&nbsp;z=!@<span&nbsp;class='name'>_GetOpt.z!&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SETLOCAL&nbsp;DISABLEDELAYEDEXPANSION</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Or&nbsp;hard&nbsp;code&nbsp;reference</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECHO&nbsp;a=%@x.z%</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Clear&nbsp;flags</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;Executing:&nbsp;x.bat&nbsp;-y:z&nbsp;-flag&nbsp;file&nbsp;-z:"hello&nbsp;world"</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;x.bat&nbsp;will&nbsp;have&nbsp;the&nbsp;environment:</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$x.x=yy</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.z=1</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.1=file</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.flag=1</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.y=z</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.z="hello&nbsp;world"</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;NOTE!&nbsp;Environment&nbsp;var&nbsp;DEBUG&nbsp;will&nbsp;enable&nbsp;debug&nbsp;info</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>REQUIRES</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;_Debug.cmd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting&nbsp;up&nbsp;debug&nbsp;environment&nbsp;for&nbsp;batch&nbsp;scripts&nbsp;</span></span></tt><BR>
<h3></span></span></h3>
<h3>SOURCE</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;C:\Users\Erik\Documents\GitHub\Underscore\_GetOpt.cmd</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h5>(c)2015 Erik Bachmann, ClicketyClick.dk (ErikBachmann@ClicketyClick.dk)</span></span></h5>

